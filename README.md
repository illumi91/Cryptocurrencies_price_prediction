#  Cryptocurrencies price prediction project by Luigi Fiori

## Files

1. crypto_dfs: raw data for each symbol
2. EDA & visualizations.ipynb: notebook for EDA
3. Time_series_prediction.ipynb: notebook for time series prediction
4. Machine_learning.ipynb: notebook for machine learning prediction
5. Neural_network_prediction.ipynb: notebook for neaural network prediction
6. Cryptocurrencies_pred_presentation.pdf: Slide presentation
7. 500crypto_joined_close.csv: raw data for all symbols (closing prices)
8. btcusd.csv: raw data Bitcoin symbol

## Introduction

For this project I will be acting as consultant for a financial company and we will try to predict cryptocurrency prices using a correlation indicator.

The idea is that being relatively difficult if not impossible to predict future prices taking in consideration just a single symbol we will be trying to get a prediction using the movements of numerous cryptocurrencies.

After this we will be using machine learning and neural network to train few models and finally evaluate the accuracy.

I will be going in order explaining which notebook goes first.

## 1) EDA & visualizations

In this notebook you can see the requests to the Binance API in order to obtain the prices and volume for each cryptocurrency.

<center><img src='https://raw.githubusercontent.com/illumi91/dsc-capstone-project-v2-online-ds-pt-051319/master/crypto_project_images/BTCtrend.PNG'>

At the end of it we create a main df with all the symbols closing prices in order to get the correlation scores and create an interactive heatmap with plotly.

<center><img src='https://raw.githubusercontent.com/illumi91/dsc-capstone-project-v2-online-ds-pt-051319/master/crypto_project_images/heatmap.PNG'>

## 2) Time_series_prediction

Before going into machine learning and neural network I wanted to to an analysis using ARIMA modelling.

<center><img src='https://raw.githubusercontent.com/illumi91/dsc-capstone-project-v2-online-ds-pt-051319/master/crypto_project_images/timeseries.PNG'>

Both the forecasts and associated confidence interval that we have generated can now be used to further understand the time series and foresee what to expect. Our forecasts show that the time series is expected to continue increasing at a steady pace as of 2020-03-12 09:00:00.

As we forecast further out into the future, it is natural for us to become less confident in our values.

This is reflected by the confidence intervals generated by our model, which grow larger as we move further out into the future.

Next we will be using machine learning to see if we can get an accurate prediction of future prices.

## 3) Machine_learning

Through our heatmap we saw that there is correlation in terms of closing price between different cryptocurrencies.

The question now is, can we get a machine learning in order to recognize those relationship?

As we saw group of companies are likely to move together either up or down but not necesserily at the same time. Most of the times people try to get a price prediction based on the history of that only cryptocurrency. In our case being this previous approach almost always useless we will try to get a prediction using numerous cryptocurrencies to see if we can get a real edge.

The steps I took are:

1. preprocessing our data creating new columns with lagged prices in the future
2. created labels hold, buy, sell
3. create feature sets X, y 
4. perform machine learning using logistic regression, decision tree and random forest
5. evaluate using accuracy and f1 scores
6. check feature importances and confusion matrix

<center><img src='https://raw.githubusercontent.com/illumi91/dsc-capstone-project-v2-online-ds-pt-051319/master/crypto_project_images/features.PNG'>

<center><img src='https://raw.githubusercontent.com/illumi91/dsc-capstone-project-v2-online-ds-pt-051319/master/crypto_project_images/conf%20matr.PNG'>

We manage to obtain a 48% score, that is 15% better than random guess.

Next we will be using neural network to see if we can get a more accurate prediction of future prices.

## 3) Neural_network_prediction

I am using a LSTM neural network for the prediction.

The steps I took are:

1. Create sequences of data formed by 72 values, that correspond to 72 hours
2. Preprocess the data creating new columns with the prices of the cryptocurrencies lagged in the future
3. Create labels buy, sell, hold based on % change between our actual values and column above
4. Create our feature sets X, y
5. Perform LSTM neural network
6. Evaluate the scores obtained

Surprising our best model accuracy is 60% that is 27% than random guessing (33%).

An extremely good result.

## Conclusions & recommendations

Our LSTM neural network performed extremely well and we are able to advice the management on implementing it through a trading bot in order to obtain the highest profit out of it .

One thing we need to mention is that the as we now the issue we are seeing about the virus is drastically making a big impact on the market with lot of volatility, for this reason I decided to exclude from the model the past 2 weeks.

I think that overall we need to operate with extreme caution being this sector so susceptible to sudden changes.